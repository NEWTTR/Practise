<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>个人方案最终确认</title>
    <link  rel="stylesheet" href="css/finalcheck.css" type="text/css">
    <script type="text/javascript" src="js/jquery-2.1.4.min.js"></script>
    <link rel="stylesheet" href="css/nav.css" type="text/css">
    <link rel="stylesheet" href="css/tail.css" type="text/css">
    <script type="text/javascript" src="js/tail.js"></script>
    <script type="text/javascript" src="js/data.js"></script>
    <link rel="stylesheet" href="css/bootstrap.min.css" type="text/css">
    <link rel="stylesheet" href="css/icheck.css" type="text/css">
    <script src="js/icheck.js" type="text/javascript"></script>
    <script type="text/javascript" src="js/bootstrap.min.js"></script>
    <script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=DTPndtW23KGhuSOeSoeunhBPzoTz4s9W"></script>
</head>

<body>
<div class="top"></div>
<!--导航栏开始-->
<div id="menu2" class="menu">
    <ul>
        <li><a href="home.html">首 页</a></li>
        <li><a href="touristspots.html">景点选择</a></li>
        <li><a href="deeplydiy.html">深度DIY</a></li>
        <li><a href="#">问题</a></li>
    </ul>
    <div class="cls"></div>
</div>
<!--导航栏结束-->

<div class="center">
    <div class="center-left">
        <!--百度地图开始-->
        <div id="allmap"></div>
        <!--百度地图结束-->
    </div>
    <div class="center-right">
        <!--1月22-->
        <div class="right-all">
            <!--<div class="day-list">
                <div class="day-list-one">
                    <p style="width: 470px; text-align: center;">第一天</p>
                    <p style="float: left; font-size: 25px;margin-top: 10px;">景点</p>
                    <div class="user">
                        <div style="float: left;  margin-left: 10px; margin-top: 10px;">
                            <input type="checkbox" id="check1" name="checkb" value="000" />
                            <label for="check1">维也纳酒店</label>
                        </div>
                        <div style="float: left;  margin-left: 10px; margin-top: 10px;">
                            <input type="checkbox" id="check2" name="checkbox" value="111" />
                            <label for="check2">补丁xxxx酒店</label>
                        </div>
                        <div style="float: left;  margin-left: 10px; margin-top: 10px;">
                            <input type="checkbox" id="check3" name="checkbox" value="222" />
                            <label for="check3">确认生成方案</label>
                        </div>
                    </div>
                </div>
                <div class="day-list-one">
                    <p style="float: left; font-size: 25px; margin-top:10px;" >酒店</p>
                    <div class="user">
                        <div class="se">
                            <input type="radio"  name="radio-sex" value="0" checked>
                            <label for="sex-man">XXXXXXXXXXXXX</label>
                        </div>
                        <div class="se">
                            <input type="radio"  name="radio-sex" value="1" >
                            <label for="sex-woman">女</label>
                        </div>
                    </div>
                </div>
            </div>-->
        </div>
        <button class="submit sub">生成最终方案</button>
    </div>
</div>

<div class="tail">
    <!-- footer -->
    <div class="wave-box">
        <div class="marquee-box marquee-up" id="marquee-box">
            <div class="marquee">
                <div class="wave-list-box" id="wave-list-box1">
                    <ul>
                        <li>
                            <img height="60" alt="波浪" src="images/wave_02.png">
                        </li>
                    </ul>
                </div>
                <div class="wave-list-box" id="wave-list-box2">
                    <ul>
                        <li>
                            <img height="60" alt="波浪" src="images/wave_02.png">
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="marquee-box" id="marquee-box3">
            <div class="marquee">
                <div class="wave-list-box" id="wave-list-box4">
                    <ul>
                        <li>
                            <img height="60" alt="波浪" src="images/wave_01.png">
                        </li>
                    </ul>
                </div>
                <div class="wave-list-box" id="wave-list-box5">
                    <ul>
                        <li>
                            <img height="60" alt="波浪" src="images/wave_01.png">
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <div class="footer">
        <div class="auto clearfix">
            <!-- footer主要-->
            <div class="five-superiority"></div>
            <div class="footer-floor1">
                <div class="footer-list">
                    <ul>
                        <li class="flist-title">产品与服务</li>
                    </ul>
                    <ul>
                        <li class="flist-title">云解决方案</li>
                    </ul>
                    <ul>
                        <li class="flist-title">技术与支持</li>
                    </ul>
                    <ul>
                        <li class="flist-title">技术与支持</li>
                    </ul>
                    <div class="clear-float"></div>
                </div>
                <div class="clear-float"></div>
            </div>
        </div>
        <div class="footer-floor2">
            <p>网站信息·1997-2018 版权所有</p>
            <p>Copyright(C)web.com, All Rights Reserved.</p>
        </div>
    </div>
    <!-- footer end -->
</div>
</body>

<!--导航栏js-->
<script type="text/javascript">
    $(document).ready(function() {
        $("#menu2 li a").wrapInner( '<span class="out"></span>' );
        $("#menu2 li a").each(function() {
            $( '<span class="over">' +  $(this).text() + '</span>' ).appendTo( this );});
        $("#menu2 li a").hover(function() {
            $(".out",	this).stop().animate({'top':	'48px'},	300); // move down - hide
            $(".over",	this).stop().animate({'top':	'0px'},		300); // move down - show
        }, function() {
            $(".out",	this).stop().animate({'top':	'0px'},		300); // move up - show
            $(".over",	this).stop().animate({'top':	'-48px'},	300); // move up - hide
        });});
</script>



<script>
    var NameInfor = sessionStorage.Name;
    var HotelNameInfor = sessionStorage.HotelName;
    var FoodNameInfor = sessionStorage.FoodName;
    var dayAll = sessionStorage.day;
    var day = parseInt(dayAll);
    selectAll();

    function selectAll() {
        $.ajax({
            type: "post",
            url: "http://localhost:8080/listbynames",
            data :{"Names":NameInfor,"HotelNames":HotelNameInfor,"FoodNames":FoodNameInfor},
            dataType: "json",
            success: function (data) {
                debugger
                    var hotel = data.hotel;
                    var sight = data.sight;
                    var food = data.food;
                    for(var i =1; i <= day; i++){
                        var formAll = "";
                        var formbegin ="<div class='day-list' id="+ i +"><p style='width: 470px; text-align: center;'>" + "第" + i + "天" + "</p>";
                        var formsightstart = "<div class='day-list-one'><p style='float: left; font-size: 25px;margin-top: 10px;'>" +"景点" + "</p>" +"<div class='user'>";
                        var formsightend = "</div></div>";
                        var formsightAll = "";
                        for(var j = 0; j < sight.length; j++){
                            var formsight = "<div style='float: left;  margin-left: 10px; margin-top: 10px;'>" +
                                "<input type='checkbox' name='sightcb' value="+ sight[j].sightName +" />"+"<label>"+ sight[j].sightName +"</label></div>";
                            formsightAll += formsight;
                        }
                        formsightstart += formsightAll;
                        formsightstart += formsightend;
                        var formfoodstart = "<div class='day-list-one'><p style='float: left; font-size: 25px;margin-top: 10px;'>" +"餐饮" + "</p>" +"<div class='user'>";
                        var formfoodend = "</div></div>";
                        var formfoodAll = "";
                        for(var k = 0; k < food.length; k++){
                            var formfood = "<div style='float: left;  margin-left: 10px; margin-top: 10px;'>" +
                                "<input type='checkbox' name='foodcb' value="+ food[k].foodName +" />"+"<label>"+ food[k].foodName +"</label></div>";
                            formfoodAll += formfood;
                        }
                        formfoodstart += formfoodAll;
                        formfoodstart += formfoodend;
                        var formhotelstart = "<div class='day-list-one'><p style='float: left; font-size: 25px;margin-top: 10px;'>" +"酒店" + "</p>" +"<div class='user' id="+ "hotel" + i +">";
                        var formhoteltend = "</div></div>";
                        var formhotelAll = "";
                        for(var m = 0; m < hotel.length; m++){
                            var formhotel = "<div class='se'>" +
                                "<input type='radio'  name='"+ "hotel" + i +"' value='"+ hotel[m].hotelName +"' id='" + "hotel" + hotel[m].hotelId + "'>"+"<label>"+ hotel[m].hotelName +"</label></div>";
                            formhotelAll += formhotel;
                            $("#"+"hotel" + hotel[m].hotelId ).val(hotel[m].hotelName);
                        }
                        formhotelstart += formhotelAll;
                        formhotelstart += formhoteltend;
                        var formend = "</div>";
                        formAll += formbegin;
                        formAll += formsightstart;
                        formAll += formfoodstart;
                        formAll += formhotelstart;
                        formAll += formend;
                        $(".right-all").append(formAll);
                    }

                //复选框单选框js
                $('.user input').each(function(){
                    var self = $(this),
                        label = self.next(),
                        label_text = label.text();
                    label.remove();
                    self.iCheck({
                        checkboxClass: 'icheckbox_sm-blue',
                        radioClass: 'radio_sm-blue',
                        insert: label_text
                    });
                });

                //景点地图展示
                for(var i=0, pointsLen = sight.length; i<pointsLen; i++) {
                    var point = new BMap.Point(sight[i].sightLongitude,sight[i].sightLatitude) ;
                    var marker = new BMap.Marker(new BMap.Point(sight[i].sightLongitude, sight[i].sightLatitude)); // 创建点
                    /*var marker = new BMap.Marker(points[i]); //将点转化成标注点*/
                    map.addOverlay(marker);  //将标注点添加到地图上
                    var thePoint = point;
                    var sightlist = sight[i];
                    showSightWindows(marker,thePoint,sightlist);
                }

                //酒店地图展示
                for(var i=0, pointsLen = hotel.length; i<pointsLen; i++) {
                    var myIcon = new BMap.Icon("images/hotelmarker.png", new BMap.Size(23, 25), {
                        offset: new BMap.Size(10, 25), // 指定定位位置
                    });
                    var point = new BMap.Point(hotel[i].hotelLongitude,hotel[i].hotelLatitude) ;
                    var marker = new BMap.Marker(new BMap.Point(hotel[i].hotelLongitude, hotel[i].hotelLatitude),{icon:myIcon}); // 创建点
                    /*var marker = new BMap.Marker(points[i]); //将点转化成标注点*/
                    map.addOverlay(marker);  //将标注点添加到地图上
                    var thePoint = point;
                    var hotellist = hotel[i];
                    showHotelWindows(marker,thePoint,hotellist);
                }

                //餐饮地图展示
                for(var i=0, pointsLen = food.length; i<pointsLen; i++) {
                    var myIcon = new BMap.Icon("images/foodmarker.png", new BMap.Size(23, 25), {
                        offset: new BMap.Size(10, 25), // 指定定位位置
                    });
                    var point = new BMap.Point(food[i].foodLongitude,food[i].foodLatitude) ;
                    var marker = new BMap.Marker(new BMap.Point(food[i].foodLongitude, food[i].foodLatitude),{icon:myIcon}); // 创建点
                    /*var marker = new BMap.Marker(points[i]); //将点转化成标注点*/
                    map.addOverlay(marker);  //将标注点添加到地图上
                    var thePoint = point;
                    var foodlist = food[i];
                    showFoodWindows(marker,thePoint,foodlist);
                }

            }
        })
    }

    //创建景点自定义窗口
    function showSightWindows(marker,point,sightlist) {
        if(sightlist.sightLevel != null){sightLevel = sightlist.sightLevel;}
        else {sightLevel = "";}
        var opts = {width : 450, height : 150,}
        var sContent =
            "<h4 style='margin:0 0 5px 0;padding:0.2em 0'>" + sightlist.sightName +"    "+  sightLevel  + "</h4>" +
            "<img style='float:right;margin:4px' width='139' height='104' id='imgDemo' src="+"images/imagesbySightId/" + sightlist.sightId + ".jpg" +">" +
            "<p style='margin:0;line-height:1.5;font-size:13px;text-indent:2em'>" + sightlist.sightBriefInfor + "</p></div>";
        var infoWindow = new BMap.InfoWindow(sContent, opts);
        marker.addEventListener("mouseover",function () {
            map.openInfoWindow(infoWindow, point);
        });
        marker.addEventListener("mouseout",function () {
            map.closeInfoWindow(infoWindow, point);
        });
    }


    //创建hotel在地图上自定义窗口
    function showHotelWindows(marker,point,hotellist) {
        var opts = {width : 275, height : 52,}
        var sContent =
            "<dl class='list-hotel-dl'>" + "<dt class='list-hotel-dt'>" +
            "<img src="+"images/imagesbyHotelId/" + hotellist.hotelId + ".png" +">" + "</dt>" +
            "<dd class='list-hotel-dd'>" +  hotellist.hotelName +  "</dd>" + "</dl>" +
            "<div class='list-hotel-price'>" + "<p class='list-hotel-price-p' style='color:#f55'>" +
            "<em>￥</em>" + "<b>" + hotellist.hotelPrice + "</b>" + "起" +  "</p>" + "</div>";
        var infoWindow = new BMap.InfoWindow(sContent, opts);
        marker.addEventListener("mouseover",function () {
            map.openInfoWindow(infoWindow, point);
        });
        /*marker.addEventListener("click",function () {
            window.open("http://www.cnblogs.com");
        });*/
        marker.addEventListener("mouseout",function () {
            map.closeInfoWindow(infoWindow, point);
        });
    }


    //创建food在地图上自定义窗口
    function showFoodWindows(marker,point,foodlist) {
        var opts = {width : 275, height : 52,}
        var sContent =
            "<dl class='list-food-dl'>" + "<dt class='list-food-dt'>" +
            "<img src="+"images/imagesbyHotelId/" + foodlist.foodId + ".png" +">" + "</dt>" +
            "<dd class='list-food-dd'>" +  foodlist.foodName +  "</dd>" + "</dl>" +
            "<div class='list-food-price'>" + "<p class='list-food-price-p' style='color:#f55'>" +
            "<em>￥</em>" + "<b>" + foodlist.foodPrice + "</b>" + "/人" +  "</p>" + "</div>";
        var infoWindow = new BMap.InfoWindow(sContent, opts);
        marker.addEventListener("mouseover",function () {
            map.openInfoWindow(infoWindow, point);
        });
        /*marker.addEventListener("click",function () {
            window.open("http://www.cnblogs.com");
        });*/
        marker.addEventListener("mouseout",function () {
            map.closeInfoWindow(infoWindow, point);
        });
    }

</script>

<!--百度地图调用js-->
<script type="text/javascript">
    var map = new BMap.Map("allmap");
    function initialize() {
        // 百度地图API功能
        map.addControl(new BMap.NavigationControl());               // 添加平移缩放控件
        map.addControl(new BMap.ScaleControl());                    // 添加比例尺控件
        map.addControl(new BMap.OverviewMapControl());              //添加缩略地图控件
        map.enableScrollWheelZoom();                            //启用滚轮放大缩小
        /* map.addControl(new BMap.MapTypeControl());  */        //添加地图类型控件
        map.centerAndZoom(new BMap.Point(120.614841,31.332454),14);
        map.enableScrollWheelZoom(true);
        // 初始化地图,设置中心点坐标和地图级别。
    }
    initialize();
</script>
<!--百度地图调用js end-->

<!--提交事件-->
<script>
    $(".sub").click(function () {
        var  obj = {}
        var sight_value =[];
        var food_value =[];
        var hotel_value =[];
        for(var i = 1; i <= day; i++) {
            $("#" + i).find('input[name="sightcb"]:checked').each(function () { //遍历，将所有选中的值放到数组中
                sight_value.push($(this).val());
                obj["sight"+i] = sight_value;
            });
            sessionStorage["sight"+i] = obj["sight"+i];
            sight_value.length = 0;

            $("#" + i).find('input[name="foodcb"]:checked').each(function () { //遍历，将所有选中的值放到数组中
                food_value.push($(this).val());
                obj["food"+i] = food_value;
            });
            sessionStorage["food"+i] = obj["food"+i];
            food_value.length = 0;

            var hotel = $("#" + i).find("input[type='radio']:checked").val();
            hotel_value.push(hotel);
            obj["hotel"+i] = hotel_value;
            sessionStorage["hotel"+i] = obj["hotel"+i];
            hotel_value.length = 0;
        }
        window.location.href = "personorder";
        /*for(var i = 1; i <= 2; i++){
            var h = $("#" + i).find("input:checkbox[name='sightcb']:checked").val();
            alert(h);
            /!*var h = $("input:checkbox[name='sightcb']:checked").val();*!/
        }*/

    })

</script>

</html>
